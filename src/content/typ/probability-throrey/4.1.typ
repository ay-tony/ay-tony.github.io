#import "../../templates/post.typ": *

#show: post.with(
  title: "概率论 4.1 条件期望",
  pub_date: (2025, 6, 21),
  upd_date: (2025, 6, 21),
  pub_time: (22, 48, 23),
  tags: ("概率论",),
  description: "",
)


#ex[
  Let $G in sG$ and show that
  $ P (G\|A) = frac(integral_G P (A\|sG) thin dd(P), integral_Omega P (A\|sG) thin dd(P)). $
  When $sG$ is the $sigma$-field generated by a partition, this
  reduces to the usual Bayes’ formula
  $ P (G_i\|A) = frac(P (A\|G_i) P (G_i), sum_j P (A\|G_j) P (G_j)). $
]
#pf[
  $
    integral_G P(A|sG) dd(P)
    &= integral_G uE(1_A|sG) dd(P)\
    &= integral_G 1_A dd(P)\
    &= P(A inter G),
  $ $
    integral_Omega P(A|sG) dd(P)
    &= uE(uE(1_A|sG))
    &= uE(1_A)
    &= P(A).
  $ 那么 $ P(G|A)=P(A inter G) / P(A). $
]

#ex[
  If $a > 0$ then
  $ P (|X|>=a|sF) lt.eq a^(- 2) uE (X^2|sF). $
]
#pf[
  对 $forall A in sG$ 有 $ 1 / a^2 integral_A uE(X^2|sF) dd(P)
  &= 1 / a^2 integral_A X^2 dd(P)\
  &>= integral_A 1_{|X|>=a} dd(P)\
  &= integral_A P(|X|>=a|sF) dd(P). $ 对 $forall epsilon > 0$，令 $A = {uE(X^2|sF)\/a^2 - P(|X|>=a|sF) <= -epsilon} in sG$，那么一定有 $P(A) = 0$ 对 $forall epsilon > 0$ 成立，那么欲证不等式是 a.s. 成立的。
]

#ex[
  $ uE (X Y\|sG)^2 lt.eq uE (X^2\|sG) uE (Y^2\|sG). $
]
#pf[
  对 $forall lambda in RR$ 有 $ uE((X + lambda Y)^2|sG)
  &= uE(X^2|sG) + 2lambda uE(X Y|sG) + lambda^2uE(Y^2|sG) >=0, $ 将其看作对 $lambda$ 的二次函数，那么有判别式 $ 0 >= Delta
  &= 4 uE(X Y|sG)^2 - 4 uE(X^2|sG)uE(Y^2|sG) $ 直接得到结论。
]

#ex[
  If $p , q in (1 , oo)$ with $1 \/ p + 1 \/ q = 1$, then
  $ uE (lr(|X Y|) divides sG) lt.eq uE (lr(|X|)^p|sG)^(1 \/ p) uE (lr(|Y|)^q|sG)^(1 \/ q). $
]
#pf[
  令 $tilde(X) = |X|\/ uE(|X|^p|sG)^(1\/p), tilde(Y) = |Y|\/ uE(|Y|^q|sG)^(1\/q)$. 由 Young 不等式知道 $ a b <= a^p \/ p + b^q \/ q $ 对 $forall a, b >= 0$ 成立，那么 $ uE(tilde(X) tilde(Y)|sG)
  &<= uE(tilde(X)^p|sG) / p + uE(tilde(Y)^q|sG) / q, $ 而 $ uE(tilde(X)^p|sG) = (uE(|X|^p|sG)) / (uE(|X|^p|sG)) = 1,\
  uE(tilde(Y)^q|sG) = (uE(|Y|^q|sG)) / (uE(|Y|^q|sG)) = 1 $ 那么 $uE(tilde(X)tilde(Y)|sG)<=1\/p+1\/q=1$，从而证明题目。
]

#ex[
  Provide an example where
  $ uE \( uE (X lr(|sF_1 \)|) sF_2) eq.not uE \( uE (X lr(|sF_2 \)|) sF_1). $
]
#pf[
  对 $Omega = {1, 2, 3}, sF_1 = sigma({1, 2}, {3}), sF_2 = sigma({1}, {2, 3})$ 和 $ P({1}) = 1 / 7, P({2}) = 2 / 7, P({3}) = 4 / 7, $ 考虑 $ uE(uE(uE(X|sF_1)|sF_2))(1, 2, 3) &= (3 / 14, 11 / 28, 11 / 28),\
  uE(uE(uE(X|sF_2)|sF_1))(1, 2, 3) &= (2 / 7, 2 / 7, 3 / 7). $
]

#ex[
  If $sG subset sF$ and $E X^2 < oo$, then
  $ uE ({ X - uE (X\|sF) }^2) + uE ({ uE (X\|sF) - uE (X\|sG) }^2) = uE ({ X - uE (X\|sG) }^2). $
  Dropping the second term gives an inequality reflecting that larger
  subspaces yield closer projections (or statistiscrly, more information
  reduces mean square error).
]
#pf[
  令 $Y = X-uE(X|sG)$，那么 $ X-uE(X|sF)
  &= Y + uE(X|sG)-uE(Y|sF)-uE(uE(X|sG)|sF)\
  &= Y - uE(Y|sF),\
  uE(X|sF)-uE(X|sG)
  &= uE(Y|sF)-uE(X|sG)-uE(Y|sG)+uE(uE(X|sG)|sG)\
  &= uE(Y|sF)-uE(Y|sG)\
  &= uE(Y|sF)-uE(X-uE(X|sG)|sG)\
  &= uE(Y|sF). $ 那么只要证明 $ uE((Y - uE(Y|sF))^2) + uE(uE(Y|sF)^2) = uE(Y^2) $ 即可。恒等变换只要证明 $ uE(Y uE(Y|sF)) = uE(uE(Y|sF)^2) $ 即可，这是因为 $ uE(Y uE(Y|sF)) = uE(uE(Y uE(Y|sF)|sF)) = uE(uE(Y|sF)^2). $
]

#ex[
  Let $sG = { nothing , Omega }$. Define
  $upright("var")(X\|sF) = uE (X^2\|sF) - uE (X\|sF)^2$.
  Show that
  $ upright("var")(X) = uE (upright("var")(X\|sF)) + upright("var")(uE (X\|sF)). $
]
#pf[
  $
    RHS
    &= uE(uE(X^2|sF)-uE(X|sF)^2)+uE(uE(X|sF)^2)-(uE(uE(X|sF)))^2\
    &= uE X^2 - (uE X)^2\
    &= LHS.
  $
]

#ex[
  Let $Y_1 , Y_2 , dots.h$ be i.i.d. with mean $mu$ and variance
  $sigma^2$, $N$ an independent positive integer-valued r.v. with
  $E N^2 < oo$, and $X = Y_1 + dots.h.c + Y_N$. Show that
  $ upright("var")(X) = sigma^2 uE N + mu^2 thin upright("var")(N). $
  #emph[Interpretation];: Consider special cases where $N$ or $Y_i$ is
  constant.
]
#pf[
  利用条件期望推导全概率公式，然后进行计算。$ uE X^2
  &= uE(uE(X^2|N))\
  &= integral_{N in NN} uE(X^2|N) dd(P)\
  &= integral_{N in NN} uE(X^2) dd(P)\
  &= sum_(n in NN) n (sigma^2 + mu^2) P(N=n)\
  &= (sigma^2 + mu^2) uE N. $ 另一方面，$ uE X
  &= uE(uE(X|N))\
  &= integral_{N in NN}uE(X|N)dd(P)\
  &= integral_{N in NN}uE(X)dd(P)\
  &= sum_(n in NN) n mu P(N=n)\
  &= mu uE N. $ 那么 $ var(X)
  &= uE X^2 - (uE X^2)\
  &= (sigma^2+mu^2)uE N - mu^2 (uE N)^2\
  &= sigma^2 uE N + mu^2 var(N). $
]

#ex[
  Show that if $X$ and $Y$ are random variables with $uE (Y\|sG) = X$
  and $E Y^2 = uE X^2 < oo$, then $X = Y$ almost surely.
]
#pf[
  由 $ uE(uE(Y|sG)^2) + uE(Y - uE(Y|sG))^2 = uE Y^2 = uE X^2 = uE(uE(Y|sG)^2) $ 直接得到 $ uE(Y - X)^2 = uE(Y - uE(Y|sG))^2 = 0 $ 然后结论是显然的。
]

#ex[
  Under the assumption $E lr(|Y|) < oo$, prove that if $uE (Y\|sG)$
  has the same distribution as $Y$, then $uE (Y\|sG) = Y$ a.s. .

  #emph[Hint];: Show
  $upright("sgn")(X) = upright("sgn")(uE (X\|sG))$ a.s. for
  $X = Y - c$.
]
#pf[
  由于 $Y, uE(Y|sG)$ 同分布，从而 $X = Y-c, uE(X|sG) = uE(Y|sG)-c$ 同分布。那么有 $uE(uE(|X|thin|sG)) = uE|X| = uE|uE(X|sG)|$，即 Jensen 不等式能够取等。那么 $|uE(X|sG)| = uE(|X|thin|sG)$ 是 a.s. 成立的。在 ${uE(X|sG)>=0}$ 上有 $ uE(|X|-X\;uE(X|sG)>0|sG) = 0 $ 从而 $X = |X|$ a.e.，再结合同分布条件得到 $X > 0$ a.e.. 类似得到 $X < 0$ a.e. 在 ${uE(X|sG)<0}$ 上。这就是 $ sgn(X) = sgn uE(X|sG). $代入 $X = Y - c$，然后对所有 $c in QQ$ 取 ${sgn(Y-c)=sgn uE(Y-c|sG)}$ 的交集得到结论。
]
